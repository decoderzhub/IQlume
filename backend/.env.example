# ==============================================================================
# brokernomex Backend Environment Configuration
# ==============================================================================

# ------------------------------------------------------------------------------
# Supabase Configuration
# ------------------------------------------------------------------------------
SUPABASE_URL=your_supabase_url_here
SUPABASE_KEY=your_supabase_anon_key_here

# ------------------------------------------------------------------------------
# Alpaca API Configuration (System-level for market data)
# ------------------------------------------------------------------------------
ALPACA_API_KEY=your_alpaca_api_key_here
ALPACA_SECRET_KEY=your_alpaca_secret_key_here
ALPACA_BASE_URL=https://paper-api.alpaca.markets

# ------------------------------------------------------------------------------
# Frontend Configuration
# ------------------------------------------------------------------------------
FRONTEND_URL=http://localhost:5173

# ------------------------------------------------------------------------------
# Background Service Intervals (in seconds)
# ------------------------------------------------------------------------------
# NOTE: These intervals control how often background services poll for updates.
# Lower values = more responsive but higher server/API load
# Higher values = less responsive but lower server/API load

# Order Fill Monitor - checks if orders have been filled
# Default: 120 seconds (was 10, caused backend crashes)
ORDER_FILL_CHECK_INTERVAL=120

# Trade Sync Service - syncs trade data from Alpaca to database
# Default: 180 seconds (was 30, caused excessive API calls)
TRADE_SYNC_INTERVAL=180

# Grid Price Monitor - monitors prices for grid trading strategies
# Default: 180 seconds (was 30, caused high polling rates)
GRID_MONITOR_INTERVAL=180

# Position Exit Monitor - checks positions against TP/SL levels
# Default: 90 seconds (was 10, caused backend overload)
EXIT_MONITOR_INTERVAL=90

# Idle sleep duration when no work is detected (in seconds)
# Default: 300 seconds (5 minutes)
IDLE_SLEEP_DURATION=300

# ------------------------------------------------------------------------------
# Service Control Flags
# ------------------------------------------------------------------------------
# Emergency kill switch - disable ALL background services
# Set to 'true' to disable all automated trading services
# Default: false
DISABLE_BACKGROUND_SERVICES=false

# Individual service toggles (true/false)
ENABLE_ORDER_FILL_MONITOR=true
ENABLE_TRADE_SYNC=true
ENABLE_GRID_MONITOR=true
ENABLE_EXIT_MONITOR=true
ENABLE_TRADING_SCHEDULER=true

# ------------------------------------------------------------------------------
# Database Query Optimization
# ------------------------------------------------------------------------------
# Maximum number of days to look back for orders/trades/positions
# Default: 7 days
MAX_QUERY_DAYS_BACK=7

# Maximum number of results to return in queries
# Default: 100 rows
MAX_QUERY_RESULTS=100

# ------------------------------------------------------------------------------
# Error Handling and Circuit Breakers
# ------------------------------------------------------------------------------
# Number of consecutive errors before doubling sleep interval
# Default: 3
ERROR_THRESHOLD_WARNING=3

# Number of consecutive errors before pausing service
# Default: 5
ERROR_THRESHOLD_PAUSE=5

# Duration to pause service after hitting error threshold (in seconds)
# Default: 300 seconds (5 minutes)
ERROR_PAUSE_DURATION=300

# ------------------------------------------------------------------------------
# Logging Configuration
# ------------------------------------------------------------------------------
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
# Default: INFO
LOG_LEVEL=INFO

# ------------------------------------------------------------------------------
# Optional: External Services
# ------------------------------------------------------------------------------
# OpenAI API Key (for AI chat features)
OPENAI_API_KEY=your_openai_api_key_here

# Stripe API Keys (for payments)
STRIPE_SECRET_KEY=your_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=your_stripe_publishable_key_here

# Plaid API Keys (for bank account linking)
PLAID_CLIENT_ID=your_plaid_client_id_here
PLAID_SECRET=your_plaid_secret_here
PLAID_ENV=sandbox

# ------------------------------------------------------------------------------
# Alpaca OAuth Configuration (for user account connections)
# ------------------------------------------------------------------------------
ALPACA_CLIENT_ID=your_alpaca_oauth_client_id_here
ALPACA_CLIENT_SECRET=your_alpaca_oauth_client_secret_here
ALPACA_OAUTH_REDIRECT_URI=http://localhost:6853/api/alpaca/oauth/callback
ALPACA_ENV=paper

# ------------------------------------------------------------------------------
# Coinbase OAuth Configuration (for cryptocurrency trading)
# ------------------------------------------------------------------------------
COINBASE_CLIENT_ID=your_coinbase_oauth_client_id_here
COINBASE_CLIENT_SECRET=your_coinbase_oauth_client_secret_here
COINBASE_OAUTH_REDIRECT_URI=http://localhost:6853/api/coinbase/oauth/callback
